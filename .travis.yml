dist: trusty
sudo: required
language: python
services:
  - mongodb
python:
  - "3.6"
cache:
  pip: true
env:
  - PANDIR=/var/huntsman POCS=/var/huntsman/POCS PANUSER=$USER
before_install:
  - sudo mkdir /var/huntsman && sudo chmod 777 /var/huntsman
  - mkdir -p $PANDIR/logs
  - pip install -U pip
  - pip install coveralls
  - cd /var/huntsman
  - git clone https://github.com/panoptes/POCS.git
  - cd POCS
  - pip install -r requirements.txt
  - python setup.py install
  - ln -s $TRAVIS_BUILD_DIR /var/huntsman/huntsman-pocs
install:
  - cd $TRAVIS_BUILD_DIR
  - pip install -r requirements.txt
  - python setup.py install
script:
  - coverage run $(which pytest) -v
  - coverage combine
after_success:
  - bash <(curl -s https://codecov.io/bash)
